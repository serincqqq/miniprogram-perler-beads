<!-- pages/preview/index.wxml -->
<navigation-bar title="预览" back="{{true}}" color="black" background="#FFF"></navigation-bar>
<view class="page-container" style="padding-top: {{statusBarHeight + navBarHeight}}px;">
  <view class="zoom-controls">
    <button size="mini" bindtap="zoomOut" disabled="{{zoomLevel <= minZoom}}">-</button>
    <text>缩放: {{displayImageScale}}倍</text>
    <button size="mini" bindtap="zoomIn" disabled="{{zoomLevel >= maxZoom}}">+</button>
  </view>
  <scroll-view scroll-x="true" scroll-y="true" class="preview-scroll-view" style="height: {{scrollViewHeight}}px;">
    <view class="image-wrapper">
      <image class="preview-image" src="{{tempFilePath}}" mode="widthFix" style="transform: scale({{displayImageScale}})" show-menu-by-longpress="{{true}}"></image>
    </view>
  </scroll-view>
  <!-- Color Palette Section -->
  <view class="color-palette-section">
    <view class="color-palette">
      <view class="color-block" wx:for="{{usedColors}}" wx:key="code" style="background-color: {{item.hex}}" data-color="{{item}}" bindtap="onColorBlockTap">
        <text class="color-code">{{item.code}}</text>
      </view>
    </view>
  </view>
  <!-- Export Button -->
  <view class="action-buttons">
    <button class="export-btn" type="primary" bindtap="onExport">导出图片</button>
  </view>
</view>
<!-- Color Replacement Dialog -->
<view class="replacement-dialog" wx:if="{{showReplaceDialog}}">
  <view class="dialog-content">
    <view class="dialog-title">输入要替换的颜色</view>
    <view class="replacement-colors">
      {{selectedColor.code}}
      ->
      <input class="cell-size-input" value="{{newColor}}" />
      <!-- <view class="color-block" wx:for="{{availableColors}}" wx:key="code" style="background-color: {{item.hex}}" data-color="{{item}}" bindtap="onReplaceColor">
        <text class="color-code">{{item.code}}</text>
      </view> -->
    </view>
    <view class="dialog-btn">
      <button type="primary" bindtap="onCancelReplace">确定</button>
      <button bindtap="onCancelReplace">取消</button>
    </view>
  </view>
</view>